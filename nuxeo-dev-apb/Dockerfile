FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1kZXYtYXBiCmRlc2NyaXB0aW9uOiBOdXhlbyBE\
ZXYgZW52aXJvbm1lbnQgd2l0aCBDSS9DRApiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBudXhlbwptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogTnV4ZW8gRGV2IGVudmly\
b25tZW50CiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgQSBmdWxsIGFuZCBtb2R1bGFyIE51eGVvIGRl\
dmVsb3BtZW50IGVudmlyb25tZW50IHRoYXQgYWxsb3dzCiAgICAgYSBjb21wbGV0ZSBDSS9DRCB3\
b3JrZmxvdy4KICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8v\
Z2l0aHViLmNvbS9udXhlby9udXhlby1vcGVuc2hpZnQvUkVBRE1FLm1kIgogIGltYWdlVXJsOiAi\
aHR0cHM6Ly93d3cubnV4ZW8uY29tL2Fzc2V0cy9pbWdzL2xvZ28zNDB4NjAucG5nIgpwbGFuczoK\
ICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZXZlbG9wbWVudCB3aXRoIEdpdCBS\
ZXBvc2l0b3J5CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6\
CiAgICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
dGl0bGU6IFByb2plY3QgTmFtZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IFByb2plY3QgcHJvcGVy\
dGllcwoKICAgICAgLSBuYW1lOiBwcm9qZWN0X2dpdF9yZXBvCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IEFkZHJlc3Mgb2YgdGhlIEdpdCBSZXBvc2l0b3J5CiAgICAgICAgZGlz\
cGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IHByb2plY3RfZ2l0\
X3JlZgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6ICJtYXN0ZXIiCiAgICAg\
ICAgdGl0bGU6IEJyYW5jaCBvZiB0aGUgR2l0IFJlcG9zaXRvcnkKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFtZTogcHJvamVjdF9naXRfc3NoCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFNTSCBrZXkgZm9yIGdpdCByZXBvIGFj\
Y2VzcyBpZiBuZWVkZWQKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgZGlz\
cGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IG51eGVvX2Nvbm5l\
Y3RfdXNlcm5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogfAogICAgICAg\
ICAgQSBOdXhlbyBDb25uZWN0IHVzZXJJZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpbnN0YW5jZSwg\
cHVsbAogICAgICAgICAgc3R1ZGlvIHByb2plY3QgZXRjLi4uCiAgICAgICAgZGlzcGxheV9ncm91\
cDogQ29ubmVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IG51eGVvX2Nvbm5lY3RfdG9rZW4K\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogfAogICAgICAgICAgQSB0b2tlbiBm\
b3IgdGhlIENvbm5lY3QgYWNjb3VudAogICAgICAgICAgKCBodHRwczovL2Nvbm5lY3QubnV4ZW8u\
Y29tL251eGVvL3NpdGUvY29ubmVjdC90b2tlbnMgKQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFz\
c3dvcmQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBDb25uZWN0IHByb3BlcnRpZXMKCiAgICAgIC0g\
bmFtZTogbnV4ZW9fc3R1ZGlvX3Byb2plY3QKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0\
aXRsZTogVGhlIG5hbWUgb2YgdGhlIHN0dWRpbyBwcm9qZWN0IHRvIHJlZ2lzdGVyIHRvCiAgICAg\
ICAgZGlzcGxheV9ncm91cDogQ29ubmVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IGhvdGZp\
eF9yZWxlYXNlX3VzZXJuYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFVz\
ZXJuYW1lIHRvIGFjY2VzcyBob3RmaXggcmVsZWFzZXMgcmVwb3NpdG9yeSAoT3B0aW9uYWwpCiAg\
ICAgICAgZGlzcGxheV9ncm91cDogQ29ubmVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IGhv\
dGZpeF9yZWxlYXNlX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6\
IFBhc3N3b3JkIHRvIGFjY2VzcyBob3RmaXggcmVsZWFzZXMgcmVwb3NpdG9yeSAoT3B0aW9uYWwp\
CiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IENv\
bm5lY3QgcHJvcGVydGllcwoKICAgICAgLSBuYW1lOiBqZW5raW5zX2dpdF9yZWxlYXNlX3VzZXJu\
YW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogb3BlbnNoaWZ0CiAgICAg\
ICAgdGl0bGU6IEdpdCB1c2VyIG5hbWUgdG8gcGVyZm9ybSByZWxlYXNlCiAgICAgICAgZGlzcGxh\
eV9ncm91cDogR2l0IGNvbmZpZ3VyYXRpb24KCiAgICAgIC0gbmFtZTogamVua2luc19naXRfcmVs\
ZWFzZV9lbWFpbAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IG9wZW5zaGlm\
dEBudXhlby5jb20KICAgICAgICB0aXRsZTogR2l0IHVzZXIgZW1haWwgdG8gcGVyZm9ybSByZWxl\
YXNlCiAgICAgICAgZGlzcGxheV9ncm91cDogR2l0IGNvbmZpZ3VyYXRpb24KCiAgICAgIC0gbmFt\
ZTogbnV4ZW9fdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICc5LjEwJwogICAgICAgIHR5cGU6IGVu\
dW0KICAgICAgICBlbnVtOiBbJzguMTAnLCc5LjEwJywgJzEwLjInLCAnbWFzdGVyJ10KICAgICAg\
ICB0aXRsZTogTnV4ZW8gdmVyc2lvbiB0byB1c2UKICAgICAgICBkaXNwbGF5X2dyb3VwOiBOdXhl\
byBDb25maWd1cmF0aW9uCgogICAgICAtIG5hbWU6IG51eGVvX3BhY2thZ2VzCiAgICAgICAgZGVm\
YXVsdDogJ251eGVvLXdlYi11aScKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTog\
TGlzdCBvZiBOdXhlbyBwYWNrYWdlcyB0byBpbnN0YWxsIGF0IHN0YXJ0dXAKICAgICAgICBkaXNw\
bGF5X2dyb3VwOiBOdXhlbyBDb25maWd1cmF0aW9uCgogICAgICAtIG5hbWU6IG51eGVvX3RlbXBs\
YXRlcwogICAgICAgIGRlZmF1bHQ6ICcnCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0\
bGU6IHwKICAgICAgICAgIENvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIE51eGVvIHRlbXBsYXRlcyB0\
byBiZSBhZGRlZCB0byB0aGUKICAgICAgICAgIGNvbmZpZ3VyYXRpb24KICAgICAgICBkaXNwbGF5\
X2dyb3VwOiBOdXhlbyBDb25maWd1cmF0aW9uCgogICAgICAtIG5hbWU6IGJhY2tlbmRfcmVwb3Np\
dG9yeV90eXBlCiAgICAgICAgZGVmYXVsdDogJ0RCUycKICAgICAgICB0eXBlOiBlbnVtCiAgICAg\
ICAgIyBUT0RPOiBNYWtlIFBvc3RncmVzIHdvcmsgYmVmb3JlIHNob3dpbmcgaXQgYXMgYXZhaWxh\
YmxlLgogICAgICAgICMgZW51bTogWydEQlMnLCAnVkNTX1Bvc3RncmVzJ10KICAgICAgICBlbnVt\
OiBbJ0RCUyddCiAgICAgICAgdGl0bGU6IFJlcG9zaXRvcnkgdHlwZQogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgICAgIC0gbmFtZTogYmFja2VuZF9zdHJlYW1fdHlw\
ZQogICAgICAgIGRlZmF1bHQ6ICdDaHJvbmljbGUnCiAgICAgICAgdHlwZTogZW51bQogICAgICAg\
ICMgVE9ETzogTWFrZSBLYWZrYSB3b3JrIGJlZm9yZSBzaG93aW5nIGl0IGFzIGF2YWlsYWJsZS4K\
ICAgICAgICAjIGVudW06IFsnQ2hyb25pY2xlJywgJ0thZmthJ10KICAgICAgICBlbnVtOiBbJ0No\
cm9uaWNsZSddCiAgICAgICAgdGl0bGU6IFN0cmVhbSB0eXBlCiAgICAgICAgZGlzcGxheV9ncm91\
cDogQmFja2VuZCBzdG9yYWdlcwoKICAgICAgLSBuYW1lOiBiYWNrZW5kX3B1YnN1Yl90eXBlCiAg\
ICAgICAgZGVmYXVsdDogaW5tZW1vcnkKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgIyBUT0RP\
OiBNYWtlIFN0cmVhbSBhbmQgUmVkaXMgd29yayBiZWZvcmUgc2hvd2luZyB0aGVtIGFzIGF2YWls\
YWJsZS4KICAgICAgICAjIGVudW06IFsnaW5tZW1vcnknLCAnc3RyZWFtJywgJ3JlZGlzJ10KICAg\
ICAgICBlbnVtOiBbJ2lubWVtb3J5J10KICAgICAgICB0aXRsZTogU3RyZWFtIHR5cGUKICAgICAg\
ICBkaXNwbGF5X2dyb3VwOiBCYWNrZW5kIHN0b3JhZ2VzCgogICAgICAtIG5hbWU6IGJhY2tlbmRf\
YmluYXJpZXNfdHlwZQogICAgICAgIGRlZmF1bHQ6IGZzCiAgICAgICAgdHlwZTogZW51bQogICAg\
ICAgICMgVE9ETzogTWFrZSBNaW5pbyBhbmQgUzMgd29yayBiZWZvcmUgc2hvd2luZyB0aGVtIGFz\
IGF2YWlsYWJsZS4KICAgICAgICAjIGVudW06IFsnZnMnLCAnbWluaW8nLCAnczMnXQogICAgICAg\
IGVudW06IFsnZnMnXQogICAgICAgIHRpdGxlOiBCaW5hcmllcyBzdG9yYWdlIHR5cGUKICAgICAg\
ICBkaXNwbGF5X2dyb3VwOiBCYWNrZW5kIHN0b3JhZ2VzCgogICAgICAjIFRPRE86IEsvViBzdG9y\
ZSB0eXBlCgogICAgICAtIG5hbWU6IGJhY2tlbmRfcHZfc3RvcmFnZV9jbGFzcwogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBTdG9yYWdlIGNsYXNzIGZvciBiYWNrZW5kIHBlcnNp\
c3RlbmNlIHZvbHVtZXMKICAgICAgICBkZWZhdWx0OiBncDIKICAgICAgICBkaXNwbGF5X2dyb3Vw\
OiBCYWNrZW5kIHN0b3JhZ2VzCgogICAgICAtIG5hbWU6IGJpbmFyaWVzX3B2X3N0b3JhZ2VfY2xh\
c3MKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogU3RvcmFnZSBjbGFzcyBmb3Ig\
YmFja2VuZCBwZXJzaXN0ZW5jZSB2b2x1bWVzIChpZiBmcyB1c2VkKQogICAgICAgIGRlZmF1bHQ6\
IHNoYXJlZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgLSBuYW1l\
OiBzdHVkaW8tb25seQogICAgZGVzY3JpcHRpb246IERldmVsb3BtZW50IHdpdGggU3R1ZGlvIHBy\
b2plY3Qgb25seQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJz\
OgogICAgICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBQcm9qZWN0IE5hbWUKCiAgICAgIC0gbmFtZTogbnV4ZW9fY29ubmVjdF91c2VybmFt\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8CiAgICAgICAgICBBIE51eGVv\
IENvbm5lY3QgdXNlcklkIHVzZWQgdG8gcmVnaXN0ZXIgdGhlIGluc3RhbmNlLCBwdWxsCiAgICAg\
ICAgICBzdHVkaW8gcHJvamVjdCBldGMuLi4KCiAgICAgIC0gbmFtZTogbnV4ZW9fY29ubmVjdF90\
b2tlbgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8CiAgICAgICAgICBBIHRv\
a2VuIGZvciB0aGUgQ29ubmVjdCBhY2NvdW50CiAgICAgICAgICAoIGh0dHBzOi8vY29ubmVjdC5u\
dXhlby5jb20vbnV4ZW8vc2l0ZS9jb25uZWN0L3Rva2VucyApCiAgICAgICAgZGlzcGxheV90eXBl\
OiBwYXNzd29yZAoKICAgICAgLSBuYW1lOiBudXhlb19zdHVkaW9fcHJvamVjdAogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgc3R1ZGlvIHByb2plY3Qg\
dG8gcmVnaXN0ZXIgdG8KCiAgICAgIC0gbmFtZTogbnV4ZW9fc3R1ZGlvX3ZlcnNpb24KICAgICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogVGhlIHZlcnNpb24gb2YgdGhlIHN0dWRpbyBw\
cm9qZWN0IHRvIHJlZ2lzdGVyIHRvCgogICAgICAtIG5hbWU6IG51eGVvX3ZlcnNpb24KICAgICAg\
ICBkZWZhdWx0OiAnOS4xMCcKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWyc4LjEw\
JywnOS4xMCcsICcxMC4yJywgJ21hc3RlciddCiAgICAgICAgdGl0bGU6IE51eGVvIHZlcnNpb24g\
dG8gdXNlCiAgICAgICAgZGlzcGxheV9ncm91cDogTnV4ZW8gQ29uZmlndXJhdGlvbgoKICAgICAg\
LSBuYW1lOiBudXhlb19wYWNrYWdlcwogICAgICAgIGRlZmF1bHQ6ICdudXhlby13ZWItdWknCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IExpc3Qgb2YgTnV4ZW8gcGFja2FnZXMg\
dG8gaW5zdGFsbCBhdCBzdGFydHVwCiAgICAgICAgZGlzcGxheV9ncm91cDogTnV4ZW8gQ29uZmln\
dXJhdGlvbgoKICAgICAgLSBuYW1lOiBiYWNrZW5kX3B2X3N0b3JhZ2VfY2xhc3MKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogU3RvcmFnZSBjbGFzcyBmb3IgYmFja2VuZCBwZXJz\
aXN0ZW5jZSB2b2x1bWVzCiAgICAgICAgZGVmYXVsdDogZ3AyCgogICAgICAtIG5hbWU6IGJpbmFy\
aWVzX3B2X3N0b3JhZ2VfY2xhc3MKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTog\
U3RvcmFnZSBjbGFzcyBmb3IgYmFja2VuZCBwZXJzaXN0ZW5jZSB2b2x1bWVzCiAgICAgICAgZGVm\
YXVsdDogc2hhcmVkCg=="




ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-dev-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb